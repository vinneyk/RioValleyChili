<section class="table-responsive">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Order Items</h3>
    </div>
    <div class="table-responsive">
      <table class="table table-striped table-condensed">
        <thead>
          <tr>
            <th></th>
            <th colspan="3">Product</th>
            <th colspan="2">Customer Code</th>
            <th colspan="2">Customer Lot</th>
            <th colspan="2">Packaging</th>
            <th>Treatment</th>
          </tr>
          <tr>
            <th></th>
            <th>Contract</th>
            <th>Qty</th>
            <th>Weight</th>
            <th>Price<br>/lb</th>
            <th>Freight<br>/lb</th>
            <th>Treatment<br>/lb</th>
            <th>Warehouse<br>/lb</th>
            <th>Rebate<br>/lb</th>
            <th>Total<br>/lb</th>
            <th>Value</th>
          </tr>
        </thead>
        <tbody data-bind="template: {
            name: tableMode,
            foreach: orderItems
          }"></tbody>
        <tfoot>
          <tr class="info">
            <td class="text-right" colspan="3">
              <b>Total Weight:</b>
            </td>
            <td colspan="2">
              <span data-bind="visible: !isMiscellaneous()"><span data-bind="text: TotalPickedWeight, css: { 'text-danger': PickedOverWeight }"></span> / </span><span data-bind="text: TotalWeight"></span>
            </td>
            <td class="text-right" colspan="5">
              <b>Total Cost:</b>
            </td>
            <td>
              <span data-bind="text: TotalCost | USD"></span>
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</section>

<section data-bind="visible: isMiscellaneous">
  <button class="btn btn-primary" data-bind="command: addMiscItem">Add order item</button>
</section>

<section data-bind="visible: !isMiscellaneous()">
  <div class="panel panel-default">
    <div class="panel-body">
      <button class="btn btn-primary btn-block" data-bind="command: getContracts, visible: !isSelectingContract()">Select Contract</button>
      <button class="btn btn-default btn-block" data-bind="click: closeContracts, visible: isSelectingContract">Close Contracts</button>
    </div>
    <div class="table-responsive" data-bind="slideVisible: isSelectingContract">
      <table class="table table-condensed table-hover table-bordered clickable">
        <thead>
          <tr>
            <th>Contract</th>
            <th>Begin Date</th>
            <th>End Date</th>
            <th>Status</th>
            <th>Product</th>
            <th>Customer Product Code</th>
            <th>Packaging</th>
            <th>Treatment</th>
            <th>Price/lb</th>
            <th>Freight</th>
            <th>Treatment</th>
            <th>Warehouse</th>
            <th>Rebate</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody class="small" data-bind="foreach: contracts, click: selectContractItem">
          <tr data-bind="css: { 'text-muted': $parent.selectedContracts().length > 0 && $parent.selectedContracts().indexOf( CustomerContractKey ) < 0 }">
            <td data-bind="text: ContractNumber"></td>
            <td data-bind="text: TermBegin | toDate"></td>
            <td data-bind="text: TermEnd | toDate"></td>
            <td data-bind="text: ContractStatus.displayValue"></td>
            <td class="no-wrap" data-bind="text: ChileProductCode + ' - ' + ChileProductName"></td>
            <td data-bind="text: CustomerProductCode"></td>
            <td data-bind="text: PackagingProductName"></td>
            <td data-bind="text: Treatment.displayValue"></td>
            <td data-bind="text: PriceBase | USD"></td>
            <td data-bind="text: PriceFreight | USD"></td>
            <td data-bind="text: PriceTreatment | USD"></td>
            <td data-bind="text: PriceWarehouse | USD"></td>
            <td data-bind="text: PriceRebate | USD"></td>
            <td data-bind="text: PriceTotal | USD"></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</section>

<script id="inventory-item" type="text/html">
  <tr>
    <td class="sales-orders-items-tools" rowspan="2">
      <button type="button" class="btn btn-link" data-bind="command: $parent.removeItem" tabindex="-1"><i class="fa fa-times"></i> </button>
      <button type="button" class="btn btn-primary" data-bind="command: $parents[1].startInventoryPicker, disable: !OrderItemKey || dirtyFlag.isDirty()" tabindex="-1">Pick</button>
    </td>
    <td colspan="3"><select class="form-control input-sm" data-bind="value: Product, options: $parent.options.productOptions, optionsText: 'ProductCodeAndName', enable: isMiscellaneous" tabindex="-1"></select></td>
    <td colspan="2"><input class="form-control input-sm" type="text" data-bind="value: CustomerProductCode" tabindex="-1"></td>
    <td colspan="2"><input class="form-control input-sm" type="text" data-bind="value: CustomerLotCode" tabindex="-1"></td>
    <td colspan="2"><select class="form-control input-sm" data-bind="value: Packaging, options: $parent.options.packaging, optionsText: 'ProductName'" tabindex="-1"></select></td>
    <td><select class="form-control input-sm" data-bind="value: TreatmentKey, options: TreatmentKey.options, optionsText: 'value'" tabindex="-1"></select></td>
  </tr>
  <tr>
    <td><span class="form-control-static input-sm align-top" data-bind="text: Contract"></span></td>
    <td data-bind="validationElement: Quantity"><input class="form-control input-sm" type="text" data-bind="value: Quantity"></td>
    <td><span class="form-control-static input-sm align-top" data-bind="text: TotalWeight"></span></td>
    <td data-bind="validationElement: PriceBase"><input class="form-control input-sm" type="text" data-bind="value: PriceBase" tabindex="-1"></td>
    <td data-bind="validationElement: PriceFreight"><input class="form-control input-sm" type="text" data-bind="value: PriceFreight" tabindex="-1"></td>
    <td data-bind="validationElement: PriceTreatment"><input class="form-control input-sm" type="text" data-bind="value: PriceTreatment" tabindex="-1"></td>
    <td data-bind="validationElement: PriceWarehouse"><input class="form-control input-sm" type="text" data-bind="value: PriceWarehouse" tabindex="-1"></td>
    <td data-bind="validationElement: PriceRebate"><input class="form-control input-sm" type="text" data-bind="value: PriceRebate" tabindex="-1"></td>
    <td><span class="form-control-static input-sm align-top" data-bind="text: TotalCostPerLb | USD"></span></td>
    <td><span class="form-control-static input-sm align-top" data-bind="text: TotalCost | USD"></span></td>
  </tr>
  <tr class="small">
    <td class="text-right" colspan="3"><b>Total Picked Weight:</b></td>
    <td colspan="8"><span data-bind="text: totalPickedWeight | number, css: { 'text-danger': pickedOverWeight }"></span> / <span data-bind="text: TotalWeight | number"></span></td>
  </tr>
</script>

<script id="non-inventory-item" type="text/html">
  <tr>
    <td class="sales-orders-items-tools" rowspan="2">
      <button type="button" class="btn btn-link" data-bind="command: $parent.removeItem"><i class="fa fa-times"></i> </button>
    </td>
    <td colspan="3" data-bind="validationElement: Product"><select class="form-control input-sm" data-bind="value: Product, options: $parent.options.productOptions, optionsText: 'ProductCodeAndName', enable: isMiscellaneous"></select></td>
    <td colspan="2"><input class="form-control input-sm" type="text" data-bind="value: CustomerProductCode"></td>
    <td colspan="2"><input class="form-control input-sm" type="text" data-bind="value: CustomerLotCode"></td>
    <td colspan="2"><select class="form-control input-sm" data-bind="value: Packaging, options: $parent.options.packaging, optionsText: 'ProductName'"></select></td>
    <td><select class="form-control input-sm" data-bind="value: TreatmentKey, options: TreatmentKey.options, optionsText: 'value'"></select></td>
  </tr>
  <tr>
    <td><span class="form-control-static input-sm align-top text-muted">N/A</span></td>
    <td data-bind="validationElement: Quantity"><input class="form-control input-sm" type="text" data-bind="value: Quantity"></td>
    <td><span class="form-control-static input-sm align-top" data-bind="text: TotalWeight"></span></td>
    <td data-bind="validationElement: PriceBase"><input class="form-control input-sm" type="text" data-bind="value: PriceBase"></td>
    <td data-bind="validationElement: PriceFreight"><input class="form-control input-sm" type="text" data-bind="value: PriceFreight"></td>
    <td data-bind="validationElement: PriceTreatment"><input class="form-control input-sm" type="text" data-bind="value: PriceTreatment"></td>
    <td data-bind="validationElement: PriceWarehouse"><input class="form-control input-sm" type="text" data-bind="value: PriceWarehouse"></td>
    <td data-bind="validationElement: PriceRebate"><input class="form-control input-sm" type="text" data-bind="value: PriceRebate"></td>
    <td><span class="form-control-static input-sm align-top" data-bind="text: TotalCostPerLb | USD"></span></td>
    <td><span class="form-control-static input-sm align-top" data-bind="text: TotalCost | USD"></span></td>
  </tr>
</script>
